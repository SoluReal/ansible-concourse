---
- name: Create web launch script
  ansible.builtin.template:
    src: concourse-web.j2
    dest: "{{ concourse_web_launcher_path }}"
    owner: "{{ concourse_user }}"
    group: "{{ concourse_group }}"
    mode: "{{ concourse_web_launcher_mode }}"
    force: true
  become: true
  notify:
    - Restart concourse web

- name: Create web service
  ansible.builtin.template:
    src: concourse-web.service.j2
    dest: /etc/systemd/system/concourse-web.service
    mode: "0644"
    force: true
  become: true
  register: concourse_web_service
  notify:
    - Restart concourse web
    - Systemd daemon reload
  tags:
    - no-test
